<div *ngIf="game | async as _game"
  class="container py-3">
  <div class="d-flex flex-row align-items-center">
    <div class="mdc-typography--headline4 mr-3">Pickup #{{ _game.number }}</div>

    <app-game-admin-buttons *ngIf="(isAdmin | async) && (isRunning | async)"
      (reinitializeServer)="reinitializeServer()"
      (forceEnd)="forceEndGame()"></app-game-admin-buttons>

    <app-game-summary *ngIf="_game.state === 'ended'"
      [logsUrl]="_game.logsUrl"
      [demoUrl]="_game.demoUrl"></app-game-summary>
  </div>

  <app-game-basic-info
    [launchedAt]="_game.launchedAt"
    [map]="_game.map"
    [gameServerName]="gameServerName | async"
    [state]="_game.state"
    [error]="_game.error"
    class="game-basic-info"></app-game-basic-info>

  <div *ngIf="isRunning | async" class="game-runtime-info">
    <div *ngIf="isMyGame | async; else watchGameInfo" class="d-flex align-items-center">
      <app-connect-string [connectString]="_game.connectString" class="flex-grow-1 mr-3"></app-connect-string>
      <app-mumble-join-button [mumbleUrl]="mumbleUrl | async"></app-mumble-join-button>
    </div>

    <ng-template #watchGameInfo>
      <app-connect-string
        [stvConnectString]="_game.stvConnectString"></app-connect-string>
    </ng-template>
  </div>

  <div class="row mt-4">
    <div class="col team-blu">
      <app-game-team-header
        team="blu"
        [score]="scoreBlu | async"></app-game-team-header>
      <app-game-team-player-list
        [players]="playersBlu | async"
        [showPlayerConnectionStatus]="isRunning | async"
        [showAdminActionButtons]="(isAdmin | async) && (isRunning | async)"
        (requestSubstitute)="requestSubstitute($event)"
        (replacePlayer)="replacePlayer($event)"
        [locked]="isLocked | async"
        class="d-block mt-4"></app-game-team-player-list>
    </div>

    <div class="col team-red">
      <app-game-team-header
        team="red"
        [score]="scoreRed | async"></app-game-team-header>
      <app-game-team-player-list
        [players]="playersRed | async"
        [showPlayerConnectionStatus]="isRunning | async"
        [showAdminActionButtons]="(isAdmin | async) && (isRunning | async)"
        (requestSubstitute)="requestSubstitute($event)"
        (replacePlayer)="replacePlayer($event)"
        [locked]="isLocked | async"
        class="d-block mt-4"></app-game-team-player-list>
    </div>
  </div>
</div>
